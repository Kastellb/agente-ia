<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Leveler</title>
    <style>
        :root {
            --primary: #2563eb;
            --secondary: #64748b;
            --background: #f8fafc;
            --card: #ffffff;
            --text: #1e293b;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--background);
            color: var(--text);
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: var(--card);
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        header {
            background: var(--primary);
            color: white;
            padding: 20px;
            text-align: center;
        }

        h1 {
            font-size: 24px;
            margin-bottom: 8px;
        }

        .search-section {
            padding: 20px;
            border-bottom: 1px solid #e2e8f0;
        }

        .search-box {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        #lessonInput {
            flex: 1;
            padding: 12px 16px;
            border: 1px solid #cbd5e1;
            border-radius: 8px;
            font-size: 16px;
        }

        #searchBtn {
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 0 20px;
            font-weight: 600;
            cursor: pointer;
        }

        .audio-controls {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
        }

        .audio-btn {
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .audio-btn.stop {
            background: var(--error);
        }

        .audio-btn:disabled {
            background: var(--secondary);
            cursor: not-allowed;
        }

        .speed-control {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-left: 15px;
        }

        .lesson-content {
            padding: 0 20px 20px;
            display: none;
        }

        .lesson-header {
            margin: 20px 0 15px;
            color: var(--primary);
        }

        .theory-content {
            background: #f1f5f9;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            line-height: 1.8;
            white-space: pre-line;
        }

        .practice-section {
            margin-top: 25px;
        }

        .practice-btn {
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 20px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: block;
            width: 100%;
        }

        .status-indicator {
            text-align: center;
            padding: 10px;
            font-style: italic;
            color: var(--secondary);
        }

        footer {
            text-align: center;
            padding: 20px;
            color: var(--secondary);
            font-size: 14px;
            border-top: 1px solid #e2e8f0;
        }

        @media (max-width: 600px) {
            .search-box {
                flex-direction: column;
            }
            
            #searchBtn {
                padding: 12px;
            }
            
            .audio-controls {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>English Leveler</h1>
            <p>Learn and practice English</p>
        </header>

        <div class="search-section">
            <div class="search-box">
                <input type="text" id="lessonInput" placeholder="Enter lesson number or name (e.g. 1 or Greetings)">
                <button id="searchBtn">Load Lesson</button>
            </div>
            
            <div class="audio-controls">
                <button class="audio-btn" id="playBtn" disabled>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polygon points="5 3 19 12 5 21 5 3"></polygon>
                    </svg>
                </button>
                <button class="audio-btn stop" id="stopBtn" disabled>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <rect x="6" y="4" width="4" height="16"></rect>
                        <rect x="14" y="4" width="4" height="16"></rect>
                    </svg>
                </button>
                
                <div class="speed-control">
                    <label for="speedSelect">Speed:</label>
                    <select id="speedSelect">
                        <option value="0.8">Slow</option>
                        <option value="1" selected>Normal</option>
                        <option value="1.2">Fast</option>
                    </select>
                </div>
            </div>
            
            <div class="status-indicator" id="statusText">Select a lesson to begin</div>
        </div>

        <div class="lesson-content" id="lessonContent">
            <h2 class="lesson-header" id="lessonTitle"></h2>
            <div class="theory-content" id="theoryContent"></div>
            
            <div class="practice-section">
                <button class="practice-btn" id="practiceBtn">Start Practice</button>
            </div>
        </div>

        <footer>
            <p>St. Mary's College English Leveler • © 2023</p>
        </footer>
    </div>

    <script>
        // Datos de lecciones
        const lessons = {
            1: {
                title: "Lesson 1: Greetings and Introductions",
                theory: `In this lesson, you will learn how to greet people, introduce yourself, and ask basic questions in English.

IMPORTANT PHRASES:
- Hello / Hi / Hey (informal)
- Good morning / Good afternoon / Good evening
- How are you? / How's it going? (informal)
- I'm fine, thank you. And you?
- Nice to meet you.
- What's your name?
- My name is...

FORMAL VS INFORMAL:
Formal greetings are used in professional settings or with people you don't know well. Informal greetings are for friends, family, and casual situations.

EXAMPLE DIALOGUE:
A: Hello, my name is Maria. What's your name?
B: Hi Maria, I'm John. Nice to meet you.
A: Nice to meet you too, John. How are you?
B: I'm good, thanks. How about you?
A: I'm doing well, thank you.

CULTURAL NOTES:
In English-speaking countries, it's common to greet people with a smile and direct eye contact. Handshakes are common in formal settings, while hugs might be appropriate among friends.`
            },
            2: {
                title: "Lesson 2: Everyday Conversations",
                theory: `This lesson focuses on common everyday conversations you might encounter in English-speaking environments.

ESSENTIAL PHRASES:
- Could you please help me?
- Where is the...?
- How much does this cost?
- I would like to order...
- What time is it?
- Excuse me / Pardon me

SHOPPING:
When shopping, you might need to ask about prices, sizes, or locations of items. Remember to be polite by using "please" and "thank you."

EXAMPLE DIALOGUE (IN A STORE):
A: Excuse me, how much is this shirt?
B: It's $25.
A: Do you have it in a larger size?
B: Yes, let me check for you.

ORDERING FOOD:
When ordering food, you can use "I'd like..." or "I'll have..." followed by what you want to order.

EXAMPLE DIALOGUE (IN A CAFE):
A: What can I get for you today?
B: I'll have a coffee and a sandwich, please.
A: Anything else?
B: No, that's all. Thank you.`
            },
            3: {
                title: "Lesson 3: Present Simple Tense",
                theory: `The Present Simple tense is used to describe habits, unchanging situations, general truths, and fixed arrangements.

FORM:
- Affirmative: Subject + verb (add -s/-es for he/she/it)
- Negative: Subject + do/does + not + verb
- Questions: Do/Does + subject + verb

USAGE:
1. Habits and routines: I drink coffee every morning.
2. Permanent situations: He works in a bank.
3. General truths: Water boils at 100 degrees Celsius.
4. Fixed arrangements: The train leaves at 8 PM.

TIME EXPRESSIONS:
- always, usually, often, sometimes, rarely, never
- every day/week/month/year
- on Mondays, at weekends

EXAMPLES:
- She doesn't eat meat. (Negative)
- Do you like music? (Question)
- The sun rises in the east. (General truth)
- They play tennis every Sunday. (Habit)`
            },
            greetings: {
                title: "Lesson 1: Greetings and Introductions",
                theory: `In this lesson, you will learn how to greet people, introduce yourself, and ask basic questions in English.

IMPORTANT PHRASES:
- Hello / Hi / Hey (informal)
- Good morning / Good afternoon / Good evening
- How are you? / How's it going? (informal)
- I'm fine, thank you. And you?
- Nice to meet you.
- What's your name?
- My name is...

FORMAL VS INFORMAL:
Formal greetings are used in professional settings or with people you don't know well. Informal greetings are for friends, family, and casual situations.

EXAMPLE DIALOGUE:
A: Hello, my name is Maria. What's your name?
B: Hi Maria, I'm John. Nice to meet you.
A: Nice to meet you too, John. How are you?
B: I'm good, thanks. How about you?
A: I'm doing well, thank you.

CULTURAL NOTES:
In English-speaking countries, it's common to greet people with a smile and direct eye contact. Handshakes are common in formal settings, while hugs might be appropriate among friends.`
            },
            conversations: {
                title: "Lesson 2: Everyday Conversations",
                theory: `This lesson focuses on common everyday conversations you might encounter in English-speaking environments.

ESSENTIAL PHRASES:
- Could you please help me?
- Where is the...?
- How much does this cost?
- I would like to order...
- What time is it?
- Excuse me / Pardon me

SHOPPING:
When shopping, you might need to ask about prices, sizes, or locations of items. Remember to be polite by using "please" and "thank you."

EXAMPLE DIALOGUE (IN A STORE):
A: Excuse me, how much is this shirt?
B: It's $25.
A: Do you have it in a larger size?
B: Yes, let me check for you.

ORDERING FOOD:
When ordering food, you can use "I'd like..." or "I'll have..." followed by what you want to order.

EXAMPLE DIALOGUE (IN A CAFE):
A: What can I get for you today?
B: I'll have a coffee and a sandwich, please.
A: Anything else?
B: No, that's all. Thank you.`
            },
            present: {
                title: "Lesson 3: Present Simple Tense",
                theory: `The Present Simple tense is used to describe habits, unchanging situations, general truths, and fixed arrangements.

FORM:
- Affirmative: Subject + verb (add -s/-es for he/she/it)
- Negative: Subject + do/does + not + verb
- Questions: Do/Does + subject + verb

USAGE:
1. Habits and routines: I drink coffee every morning.
2. Permanent situations: He works in a bank.
3. General truths: Water boils at 100 degrees Celsius.
4. Fixed arrangements: The train leaves at 8 PM.

TIME EXPRESSIONS:
- always, usually, often, sometimes, rarely, never
- every day/week/month/year
- on Mondays, at weekends

EXAMPLES:
- She doesn't eat meat. (Negative)
- Do you like music? (Question)
- The sun rises in the east. (General truth)
- They play tennis every Sunday. (Habit)`
            }
        };

        // Elementos DOM
        const lessonInput = document.getElementById('lessonInput');
        const searchBtn = document.getElementById('searchBtn');
        const lessonContent = document.getElementById('lessonContent');
        const lessonTitle = document.getElementById('lessonTitle');
        const theoryContent = document.getElementById('theoryContent');
        const practiceBtn = document.getElementById('practiceBtn');
        const playBtn = document.getElementById('playBtn');
        const stopBtn = document.getElementById('stopBtn');
        const speedSelect = document.getElementById('speedSelect');
        const statusText = document.getElementById('statusText');

        // Variables de estado
        let currentUtterance = null;
        let currentLessonText = "";

        // Cargar lección
        function loadLesson() {
            const input = lessonInput.value.trim().toLowerCase();
            
            if (!input) {
                alert("Please enter a lesson number or name");
                return;
            }
            
            let lesson;
            
            // Buscar por número
            if (lessons[input]) {
                lesson = lessons[input];
            } 
            // Buscar por palabra clave
            else if (input.includes("greet") && lessons[1]) {
                lesson = lessons[1];
            } 
            else if ((input.includes("conversation") || input.includes("everyday")) && lessons[2]) {
                lesson = lessons[2];
            }
            else if ((input.includes("present") || input.includes("simple")) && lessons[3]) {
                lesson = lessons[3];
            }
            else {
                alert("Lesson not found. Try: 1, 2, 3, 'greetings', 'conversations', or 'present'");
                return;
            }
            
            // Mostrar contenido
            lessonTitle.textContent = lesson.title;
            theoryContent.textContent = lesson.theory;
            lessonContent.style.display = 'block';
            
            // Guardar texto para lectura
            currentLessonText = `${lesson.title}. ${lesson.theory}`;
            
            // Habilitar controles de audio
            playBtn.disabled = false;
            stopBtn.disabled = false;
            
            // Actualizar estado
            statusText.textContent = "Lesson loaded. Click play to listen";
            
            // Desplazar a la lección
            lessonContent.scrollIntoView({ behavior: 'smooth' });
        }

        // Reproducir audio
        function playAudio() {
            if (!currentLessonText) return;
            
            // Detener audio actual si está reproduciendo
            stopAudio();
            
            // Crear nueva utterance
            currentUtterance = new SpeechSynthesisUtterance(currentLessonText);
            
            // Configurar voz en inglés
            const voices = speechSynthesis.getVoices();
            const englishVoice = voices.find(voice => 
                voice.lang.startsWith('en') && voice.localService === true
            );
            
            if (englishVoice) {
                currentUtterance.voice = englishVoice;
            }
            
            // Configurar velocidad
            currentUtterance.rate = parseFloat(speedSelect.value);
            
            // Eventos
            currentUtterance.onstart = () => {
                statusText.textContent = "Playing...";
                playBtn.disabled = true;
            };
            
            currentUtterance.onend = () => {
                statusText.textContent = "Playback finished";
                playBtn.disabled = false;
                currentUtterance = null;
            };
            
            currentUtterance.onerror = (event) => {
                console.error('Speech synthesis error:', event);
                statusText.textContent = "Error playing audio";
                playBtn.disabled = false;
                currentUtterance = null;
            };
            
            // Reproducir
            speechSynthesis.speak(currentUtterance);
        }

        // Detener audio
        function stopAudio() {
            if (speechSynthesis.speaking) {
                speechSynthesis.cancel();
                statusText.textContent = "Playback stopped";
                playBtn.disabled = false;
            }
        }

        // Cambiar velocidad
        function changeSpeed() {
            if (currentUtterance && speechSynthesis.speaking) {
                currentUtterance.rate = parseFloat(speedSelect.value);
                stopAudio();
                playAudio();
            }
        }

        // Iniciar práctica
        function startPractice() {
            alert("Practice session would start here. This feature will be implemented in the next version.");
        }

        // Cargar voces disponibles
        function loadVoices() {
            // En algunos navegadores, las voces no están disponibles inmediatamente
            if (speechSynthesis.getVoices().length > 0) {
                return;
            }
            
            // Esperar a que las voces estén cargadas
            speechSynthesis.onvoiceschanged = () => {
                console.log("Voices loaded:", speechSynthesis.getVoices().length);
            };
        }

        // Event listeners
        searchBtn.addEventListener('click', loadLesson);
        
        lessonInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                loadLesson();
            }
        });
        
        playBtn.addEventListener('click', playAudio);
        stopBtn.addEventListener('click', stopAudio);
        speedSelect.addEventListener('change', changeSpeed);
        practiceBtn.addEventListener('click', startPractice);

        // Inicializar
        window.addEventListener('load', () => {
            loadVoices();
            
            // Verificar compatibilidad con speech synthesis
            if (!('speechSynthesis' in window)) {
                statusText.textContent = "Speech synthesis not supported in your browser";
                playBtn.disabled = true;
                stopBtn.disabled = true;
            }
        });
    </script>
</body>
</html>
